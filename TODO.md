# Py_artnet - TODO Liste

## Geplante Features

### Performance-Optimierung
- [ ] Video-Optimierungs-Script erstellen
  - [ ] Automatische Skalierung auf Canvas-Größe
  - [ ] Hardware-Codec Encoding (H.264 mit NVENC/QSV)
  - [ ] Bitrate-Optimierung für schnelleres Decoding
  - [ ] Keyframe-Intervall anpassen (g=30 für bessere Loop-Performance)
  - [ ] Batch-Processing für alle Videos in Kanal-Ordnern
- [ ] Neues Cache-Format für Unified Player
  - [ ] Full-Frame Caching (statt RGB-Punkt-Daten)
  - [ ] Komprimierte Frame-Arrays (msgpack/lz4)
  - [ ] Cache-Kompatibilität mit VideoSource
  - [ ] Migration alter Cache-Dateien

### Weitere Verbesserungen
- [ ] Web CLI und Console Commands vereinheitlichen
  - [ ] Gemeinsame Command-Handler Logik
  - [ ] Einheitliche Befehlssyntax und Rückgabewerte
  - [ ] Code-Deduplizierung zwischen CLI Handler und API Console
- [ ] Unit Tests erweitern (Player, FrameSource, API)
- [ ] API-Authentifizierung (Basic Auth/Token)
- [ ] PyInstaller EXE Build Setup
  - [ ] Spec-Datei erstellen mit allen Dependencies
  - [ ] Static files, config.json, data/video Ordner inkludieren
  - [ ] Single-File oder Folder-basierte Distribution testen
  - ✓ Web-Interface Verbesserungen
    - ✓ Console Component in separates JS-Modul ausgelagert
    - ✓ Responsive Design für Mobile optimiert
    - ✓ LocalStorage für Settings Persistence (Brightness, Speed)
    - ✓ Canvas-Zoom & Scrollbars (Zoom per Maus & Buttons, automatische Scrollbalken)
    - ✓ Toast-Benachrichtigungen (statt alert, Theme-aware)
    - ✓ Server-Projektverwaltung (CRUD, Download, Modal-UI)
- [ ] Konfiguration erweitern
  - [ ] Environment Variable Support (target_ip, ports)
  - [ ] JSON Schema Validation für config.json
  - [ ] Hot-Reload (config.json watcher)
- [ ] Projekt-Struktur
  - [ ] CDN für Bootstrap Icons
  - [ ] Dockerfile erstellen
  - [ ] requirements-lock.txt (pip freeze)

## Abgeschlossen ✓

### v2.0 - Unified Player Architecture (2025-11-20)
- ✓ Frame Source Abstraction (FrameSource base class)
- ✓ VideoSource Implementation (OpenCV-basiert, GIF-Support)
- ✓ ScriptSource Implementation (ScriptGenerator-Integration)
- ✓ Unified Player mit source switching
- ✓ Alle API-Routen aktualisiert (video/script loading)
- ✓ CLI Handler Migration (video/script/points)
- ✓ DMX Controller Integration
- ✓ Backward Compatibility (alte VideoPlayer/ScriptPlayer als deprecated)
- ✓ Stop/Start/Restart Playback-Fixes
- ✓ 90% Code-Duplikation eliminiert (~1300 → 850 Zeilen + neue Architektur)

### v1.x - Initial Implementation
- ✓ CLI-Steuerung implementiert
- ✓ DMX-Input über Art-Net (Universum 100)
- ✓ DMX-Test-App erstellt
- ✓ Video-Player mit Art-Net Output
- ✓ Numpy-Optimierung für RGB-Extraktion
- ✓ 8-Universen-Grenze Logik
- ✓ Brightness/Speed/Loop Steuerung
- ✓ Pause/Resume Funktionalität
- ✓ Blackout Funktion
- ✓ Code-Refactoring (Module-Struktur)
- ✓ Konfigurationsdatei (config.json)
- ✓ Video-Slot System (4 Kanäle, 1020 Videos, DMX Ch6-9)
- ✓ Hardware-Beschleunigung aktiviert mit Status-Ausgabe
- ✓ Kanal-Ordner System (kanal_1 bis kanal_4)
- ✓ Testmuster (Farben)
- ✓ RGB-Aufzeichnung
- ✓ Live-Statistiken
- ✓ Canvas-Größe Skalierung
- ✓ Multi-JSON Punkte-Verwaltung (list/validate/switch/reload)
- ✓ JSON Schema Validierung mit jsonschema
- ✓ Flask REST API komplett implementiert
  - ✓ Alle Playback Endpoints (play/stop/pause/resume/restart)
  - ✓ Settings Endpoints (brightness/speed/fps/loop)
  - ✓ Art-Net Endpoints (blackout/test)
  - ✓ Video Management (list/load)
  - ✓ Points Management (list/switch/reload/validate/current)
  - ✓ Status & Info & Stats Endpoints
  - ✓ Recording Endpoints (start/stop)
  - ✓ Console Endpoints (log/command/clear)
  - ✓ CORS Support aktiviert
- ✓ Web-Interfaces implementiert
  - ✓ Bootstrap GUI (index.html) - Canvas Editor
  - ✓ Control Panel (controls.html) - Playback Steuerung
  - ✓ Dark Mode mit LocalStorage
  - ✓ Externe CSS-Datei (styles.css)
  - ✓ Externe JS-Dateien (editor.js, controls.js)
  - ✓ Navigation zwischen GUIs
- ✓ WebSocket Support für Live-Updates
  - ✓ Flask-SocketIO Integration
  - ✓ Status Broadcasting (alle 2s)
  - ✓ Console Live-Updates
  - ✓ Fallback auf REST Polling
  - ✓ Werkzeug "write() before start_response" Bug gefixt (manage_session=False + disconnect error handling)
- ✓ Points Switch/Reload via REST API
  - ✓ /api/points/switch mit Validierung
  - ✓ /api/points/reload für aktuelles File
  - ✓ Auto-restart bei laufendem Video
- ✓ Bessere Error Handling & Validierung
  - ✓ Try/Except in allen API Endpoints
  - ✓ HTTP Status Codes (200, 400, 404, 500)
  - ✓ JSON Schema Validierung vor Points-Switch
- ✓ API Modularisierung
  - ✓ api_routes.py (Playback, Settings, Art-Net)
  - ✓ api_points.py (Points Management)
  - ✓ api_videos.py (Video Management)
  - ✓ api_console.py (Console & Commands)
- ✓ Dokumentation
  - ✓ docs/API.md (500+ Zeilen, alle Endpoints)
  - ✓ WebSocket Events dokumentiert
- ✓ Testing
  - ✓ tests/test_main.py (4 Test-Klassen)
  - ✓ Validator, ArtNetManager, Cache, Error Tests
- ✓ RGB Cache Infrastruktur
  - ✓ cache/ Ordner erstellt
  - ✓ cache clear/info CLI Befehle
  - ✓ config.json Einträge
  - ✓ .gitignore Patterns
- ✓ Art-Net Code Separation
  - ✓ artnet_manager.py Modul
  - ✓ Test-Pattern mit Gradient
  - ✓ Automatischer Art-Net Start
- ✓ Konfigurationswerte ausgelagert
  - ✓ API Host/Port/Secret Key in config.json
  - ✓ Art-Net FPS/Even Packet/Broadcast
  - ✓ Video Delays (shutdown/frame_wait/recording_stop)
  - ✓ Console Log Buffer Size
  - ✓ Status Broadcast Interval
  - ✓ Frontend Polling Interval
  - ✓ Frontend-Config API Endpoint (/api/config/frontend)
- ✓ RGB-Kanal-Reihenfolge pro Universum (Channel Mapping)
  - ✓ Unterstützt alle 6 Permutationen (RGB, GRB, BGR, RBG, GBR, BRG)
  - ✓ universe_configs in config.json
  - ✓ _reorder_channels() Methode in ArtNetManager
  - ✓ CLI-Befehle: artnet map/show mit Range-Syntax
  - ✓ Testmuster berücksichtigen Channel Mapping
  - ✓ Dokumentation in README und API.md
- ✓ Prozedural generierte Grafiken (Script Generator)
  - ✓ ScriptGenerator Klasse (list/load/generate)
  - ✓ ScriptPlayer Klasse (kompatibel mit VideoPlayer API)
  - ✓ Python Script API: generate_frame(frame_number, width, height, time, fps)
  - ✓ 3 Beispiel-Shaders (rainbow_wave, plasma, pulse)
  - ✓ METADATA-System für Script-Infos
  - ✓ CLI-Befehle: scripts list, script:<name>
  - ✓ REST API Endpoints: GET /api/scripts, POST /api/load_script
  - ✓ Vollständige Dokumentation (scripts/README.md)
  - ✓ Error Handling mit Traceback
  - ✓ Lazy Module Loading (__init__.py __getattr__)
  - ✓ Dokumentation in README und API.md
